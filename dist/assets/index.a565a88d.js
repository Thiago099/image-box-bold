(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function y(_){return b(new A(_))}function b(_){function e(n,r){return typeof n[r]!="function"&&typeof n[r]!="object"?n[r]:(r.startsWith("$")&&(r=r.substring(1)),typeof n[r]=="function"?function(...f){return n[r].apply(n,f)}.bind(this):new Proxy(n[r],{set:(f,i,l)=>(t.__handleEffect(t.__isReactive(l),()=>{f[i]=t.__handleFunction(l)}),!0),get:(f,i)=>e(f,i)}))}const t=new Proxy(_,{get:(n,r)=>{if(r in n)return n[r];if(r in n.__element)return e(n.__element,r)},set:(n,r,o)=>r in n?(n[r]=o,!0):(r.startsWith("$")&&(r=r.substring(1)),r=="style"?n.$set_style(o):r in n.__element&&n.$property(r,o),!0)});return t}class A{constructor(e){if(typeof e=="string")this.__element=document.createElement(e);else if(e instanceof HTMLElement)this.__element=e;else throw new Error("Invalid element name");this.__events=[],this.__children=[],this.__states=new Set,this.__unmounted_events=[],this.__mounted_events=[],this.__parent=null}__update(){for(const e of this.__events)e()}$click(){return this.__element.click(),this}$find(e){var t=[];this.__element.matches(e)&&t.push(b(this));for(const n of this.__children)t=t.concat(n.$find(e));return t}$update(){for(const e of this.__events)e();for(const e of this.__children)e.$update()}__parseInput(e){if(e&&e.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"){for(const t of e.elements)t&&t.__subscribe&&(this.__states.add(t),t.__subscribe(this));return e.expression}return e}__observeParent(){setTimeout(()=>{for(const t of this.__mounted_events)t()},0),new MutationObserver(t=>{for(const n of t){if(n.type==="childList"&&n.removedNodes.length){for(const r of n.removedNodes)if(r===this.__element){this.__unsubscribe();for(const o of this.__unmounted_events)o()}}if(n.type==="childList"&&n.addedNodes.length){for(const r of n.addedNodes)if(r===this.__element){this.__subscribe();for(const o of this.__mounted_events)o()}}}}).observe(this.__element.parentElement,{childList:!0})}__subscribe(){if(this.__states)for(const e of this.__states)e.__subscribe(this)}__unsubscribe(){for(const e of this.__children)e.__unsubscribe();if(this.__states)for(const e of this.__states)e.__unsubscribe(this)}__handleFunction(e){return typeof e=="function"?e():e}__handleEffect(e,t){e?(t(),this.__events.push(t)):t()}__isReactive(...e){for(const t of e)if(typeof t=="function")return!0;return!1}$if(e){return e=this.__parseInput(e),this.__handleEffect(this.__isReactive(e),()=>{const t=this.__handleFunction(e);this.$style("display",t?"":"none")}),this}$class(e,t=!0){e=this.__parseInput(e),t=this.__parseInput(t);var n=null;return this.__handleEffect(this.__isReactive(e,t),()=>{const r=this.__handleFunction(e);if(r)if(typeof r=="object")for(const o in r)r[o]?this.__element.classList.add(o):this.__element.classList.remove(o);else this.__handleFunction(t)?(this.__isReactive(e)&&(n&&this.__element.classList.remove(...n.split(" ").filter(o=>o.length>0)),n=r),this.__element.classList.add(...r.split(" ").filter(o=>o.length>0))):(this.__element.classList.remove(...r.split(" ").filter(o=>o.length>0)),n=null)}),this}get parentElement(){return this.__parent}$parent(e){return this.__parent=e,e.__element!==void 0?(e.__element.appendChild(this.__element),e.__children.push(this)):e.appendChild(this.__element),this.__observeParent(),this}$parentBefore(e){return this.__parent=e,e.__element!==void 0?e.__element.firstChild?e.__element.insertBefore(this.__element,e.__element.firstChild):e.__element.appendChild(this.__element):e.firstChild?e.insertBefore(this.__element,e.firstChild):e.appendChild(this.__element),this.__observeParent(),this}$on(e,t){return e==="mounted"?(this.__onMounted(t),this):e==="unmounted"?(this.__onUnmounted(t),this):e==="update"?(this.__onUpdate(t),this):(this.__element.addEventListener(e,t),this)}__onUpdate(e){return this.__events.push(e),this}__onMounted(e){this.__mounted_events.push(e)}__onUnmounted(e){this.__unmounted_events.push(e)}$property(e,t){return e=this.__parseInput(e),t=this.__parseInput(t),this.__handleEffect(this.__isReactive(e,t),()=>{this.__element[this.__handleFunction(e)]=this.__handleFunction(t)}),this}$style(e,t=null){return t?(this.__style(e,t),this):(e=this.__parseInput(e),this.__handleEffect(this.__isReactive(e),()=>{var n=this.__handleFunction(e);if(typeof n=="object")for(const r in n)this.__element.style[r]=n[r];else{const r=n.split(";").filter(o=>o.length>0);this.__element.style={};for(const o of r){const[f,i]=o.split(":");this.__element.style.setProperty(f,this.__handleFunction(i))}}}),this)}__style(e,t){return e=this.__parseInput(e),t=this.__parseInput(t),this.__handleEffect(this.__isReactive(e,t),()=>{this.__element.style[this.__handleFunction(e)]=this.__handleFunction(t)}),this}$get_computed_style(e){return window.getComputedStyle(this.__element).getPropertyValue(e)}$child(e){e=this.__parseInput(e);var t;this.__isReactive(e)?t=y("span").$parent(this):t=this;var n=null;return this.__handleEffect(this.__isReactive(e),()=>{var r=this.__handleFunction(e);n&&n();const o=i=>i==null?()=>{}:i.__element!==void 0?(i.$parent(t),()=>i.$remove()):(i instanceof HTMLElement||(i=document.createTextNode(i)),t.__element.appendChild(i),()=>i.remove());if(Array.isArray(r)){var f=[];for(const i of r)f.push(o(i));n=()=>{for(const i of f)i()}}else n=o(r)}),this}$remove(){return this.__parent=null,this.__element.remove(),this}$model([e,t]){return this.$property("value",e),this.$on("input",n=>t(n.target.value)),this}}function S(_){return new Proxy({},{get:function(e,t){if(!!_){if(t.startsWith("$"))return T(_[t.substr(1)]);if(_[t])return F(_[t])}}})}function F(_){return _&&_.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"?_.expression():_}function T(_){return _&&_.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"?_.expression:()=>_}const g=(_,e,...t)=>{var n,r=!1;if(typeof _=="function"){if(n=_(S(e),...t),n===void 0)return t;r=!0}else n=y(_);const o={ref:i=>{i.__ref_object=n},style:i=>{n.$style(i)},class:i=>{n.$class(i)},parent:i=>{n.$parent(i)},if:i=>{n.$if(i)},model:([i,l])=>{n.$model([i,l])}},f={on:(i,l)=>{n.$on(i,l)}};if(e)for(const[i,l]of Object.entries(e)){const c=i.split(":");c.length==2?f[c[0]]&&f[c[0]](c[1],l):o[i]?o[i](l):r||n.$property(i,l)}if(t&&!r)for(const i of t)n.$child(i);return n},d=g("canvas",null),p=g("input",{type:"number",value:"1"});d.width=500;d.height=500;d.$parent(document.body);p.$parent(document.body);var s=d.getContext("webgl2"),L=[-1,-1,1,-1,-1,1,1,1],$=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,$);s.bufferData(s.ARRAY_BUFFER,new Float32Array(L),s.STATIC_DRAW);var C=`
     attribute vec2 a_position;
     void main() {
         gl_Position = vec4(a_position, 0, 1);
     }
 `,m=(_=0)=>`
     precision mediump float;
     uniform sampler2D u_texture;
     void main() {
            vec2 fragCoord = gl_FragCoord.xy;
            vec2 uv = vec2(fragCoord.x, -fragCoord.y+500.0);

            vec4 color = vec4(1.0);
            for (int i = 0; i < ${_}; i++) {
                for (int j = 0; j < ${_}; j++) {
                  vec2 offset = vec2(float(i - ${Math.floor(_/2)}), float(j - ${Math.floor(_/2)}));

                  color = min(color,texture2D(u_texture, clamp((uv + offset * 1.0)/500.0,0.0,1.0) ));
                }
              }

            gl_FragColor = vec4(clamp(color.xyz, 0.0, 1.0),1);
     }
 `;console.log(m(1));var v=s.createShader(s.VERTEX_SHADER);s.shaderSource(v,C);s.compileShader(v);var u=s.createShader(s.FRAGMENT_SHADER);s.shaderSource(u,m());s.compileShader(u);var h=s.createProgram();s.attachShader(h,v);s.attachShader(h,u);s.linkProgram(h);s.useProgram(h);s.bindBuffer(s.ARRAY_BUFFER,$);var E=s.getAttribLocation(h,"a_position");s.enableVertexAttribArray(E);s.vertexAttribPointer(E,2,s.FLOAT,!1,0,0);function R(){s.shaderSource(u,m(p.value)),s.compileShader(u),s.attachShader(h,u),s.linkProgram(h),s.useProgram(h)}p.$on("change",R);R();var a=new Image;a.onload=function(){var _=s.createTexture();s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,_),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,a),s.generateMipmap(s.TEXTURE_2D),s.uniform1i(s.getUniformLocation(h,"u_texture"),0),x()};a.src="image.png";function x(){requestAnimationFrame(x),s.drawArrays(s.TRIANGLE_STRIP,0,4)}
